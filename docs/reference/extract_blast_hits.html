<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract top blast hits from multiple blast output files — extract_blast_hits • baitfindR</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Extract top blast hits from multiple blast output files — extract_blast_hits" />

<meta property="og:description" content="BLAST results files must be in tabular format (e.g., outfmt 6). For each
BLAST results file, the single top hit (sorted by ascending evalue, then
descending bitscore) will be extracted from the BLAST database and written
to `out_dir`." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">baitfindR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/translation.html">Translation</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/joelnitta/baitfindR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract top blast hits from multiple blast output files</h1>
    <small class="dont-index">Source: <a href='https://github.com/joelnitta/baitfindR/blob/master/R/blast.R'><code>R/blast.R</code></a></small>
    <div class="hidden name"><code>extract_blast_hits.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>BLAST results files must be in tabular format (e.g., outfmt 6). For each
BLAST results file, the single top hit (sorted by ascending evalue, then
descending bitscore) will be extracted from the BLAST database and written
to `out_dir`.</p>
    
    </div>

    <pre class="usage"><span class='fu'>extract_blast_hits</span>(<span class='no'>blast_results_dir</span>, <span class='no'>blast_results_pattern</span>,
  <span class='kw'>blast_cols</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"qseqid"</span>, <span class='st'>"sseqid"</span>, <span class='st'>"pident"</span>, <span class='st'>"length"</span>, <span class='st'>"mismatch"</span>,
  <span class='st'>"gapopen"</span>, <span class='st'>"qstart"</span>, <span class='st'>"qend"</span>, <span class='st'>"sstart"</span>, <span class='st'>"send"</span>, <span class='st'>"evalue"</span>, <span class='st'>"bitscore"</span>),
  <span class='no'>database_path</span>, <span class='no'>out_dir</span>, <span class='kw'>out_ext</span> <span class='kw'>=</span> <span class='st'>"bestmatch.fasta"</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>blast_results_dir</th>
      <td><p>Path to folder containing BLAST results files.</p></td>
    </tr>
    <tr>
      <th>blast_results_pattern</th>
      <td><p>Optional; pattern used for matching with grep.
Only files with names matching the pattern will be used to extract top blast
hits.</p></td>
    </tr>
    <tr>
      <th>blast_cols</th>
      <td><p>Character vector; column names of BLAST results. See
https://www.ncbi.nlm.nih.gov/books/NBK279684/ (Table C1) for details. Must
include at least 'sseqid', 'evalue', and 'bitscore'. Defaults to standard
columns for output format 6.</p></td>
    </tr>
    <tr>
      <th>database_path</th>
      <td><p>Path to the BLAST database, including the database
name.</p></td>
    </tr>
    <tr>
      <th>out_dir</th>
      <td><p>Path to folder to write results.</p></td>
    </tr>
    <tr>
      <th>out_ext</th>
      <td><p>File extension used when writing out top BLAST hit.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional other arguments. Not used by this function,
but meant to be used by <code><a href='https://www.rdocumentation.org/packages/drake/topics/drake_plan'>drake_plan</a></code> for tracking
during workflows.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>TRUE when runs successfully; externally, the top blast hit for each
fasta result will be written to `out_dir`.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>ape</span>)

<span class='co'># Make temp dir for storing files</span>
<span class='no'>temp_dir</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>fs</span><span class='kw ns'>::</span><span class='fu'><a href='http://fs.r-lib.org/reference/create.html'>dir_create</a></span>(<span class='kw pkg'>fs</span><span class='kw ns'>::</span><span class='fu'><a href='http://fs.r-lib.org/reference/path.html'>path</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>(), <span class='st'>"baitfindR_example"</span>))

<span class='co'># Write out ape::woodmouse dataset as DNA</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>woodmouse</span>)
<span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/ape/topics/write.dna'>write.FASTA</a></span>(<span class='no'>woodmouse</span>, <span class='kw pkg'>fs</span><span class='kw ns'>::</span><span class='fu'><a href='http://fs.r-lib.org/reference/path.html'>path</a></span>(<span class='no'>temp_dir</span>, <span class='st'>"woodmouse.fasta"</span>))
<span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/ape/topics/write.dna'>write.FASTA</a></span>(<span class='no'>woodmouse</span>, <span class='kw pkg'>fs</span><span class='kw ns'>::</span><span class='fu'><a href='http://fs.r-lib.org/reference/path.html'>path</a></span>(<span class='no'>temp_dir</span>, <span class='st'>"woodmouse2.fasta"</span>))

<span class='co'># Make blast database</span>
<span class='fu'><a href='build_blast_db.html'>build_blast_db</a></span>(
  <span class='kw pkg'>fs</span><span class='kw ns'>::</span><span class='fu'><a href='http://fs.r-lib.org/reference/path.html'>path</a></span>(<span class='no'>temp_dir</span>, <span class='st'>"woodmouse.fasta"</span>),
  <span class='kw'>db_type</span> <span class='kw'>=</span> <span class='st'>"nucl"</span>,
  <span class='kw'>out_name</span> <span class='kw'>=</span> <span class='st'>"wood"</span>,
  <span class='kw'>parse_seqids</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>wd</span> <span class='kw'>=</span> <span class='no'>temp_dir</span>)</div><div class='output co'>#&gt; 
#&gt; 
#&gt; Building a new DB, current time: 05/15/2019 16:40:43
#&gt; New DB name:   /tmp/RtmpeNC9nF/baitfindR_example/wood
#&gt; New DB title:  /tmp/RtmpeNC9nF/baitfindR_example/woodmouse.fasta
#&gt; Sequence type: Nucleotide
#&gt; Keep MBits: T
#&gt; Maximum file size: 1000000000B
#&gt; Adding sequences from FASTA; added 15 sequences in 0.0116849 seconds.</div><div class='output co'>#&gt; $status
#&gt; [1] 0
#&gt; 
#&gt; $stdout
#&gt; [1] "\n\nBuilding a new DB, current time: 05/15/2019 16:40:43\nNew DB name:   /tmp/RtmpeNC9nF/baitfindR_example/wood\nNew DB title:  /tmp/RtmpeNC9nF/baitfindR_example/woodmouse.fasta\nSequence type: Nucleotide\nKeep MBits: T\nMaximum file size: 1000000000B\nAdding sequences from FASTA; added 15 sequences in 0.0116849 seconds.\n"
#&gt; 
#&gt; $stderr
#&gt; [1] ""
#&gt; 
#&gt; $timeout
#&gt; [1] FALSE
#&gt; </div><div class='input'>
<span class='co'># Blast the original sequences against the database</span>
<span class='fu'><a href='blast_n_list.html'>blast_n_list</a></span>(
  <span class='kw'>fasta_folder</span> <span class='kw'>=</span> <span class='no'>temp_dir</span>,
  <span class='kw'>fasta_pattern</span> <span class='kw'>=</span> <span class='st'>"fasta"</span>,
  <span class='kw'>database_path</span> <span class='kw'>=</span> <span class='kw pkg'>fs</span><span class='kw ns'>::</span><span class='fu'><a href='http://fs.r-lib.org/reference/path.html'>path</a></span>(<span class='no'>temp_dir</span>, <span class='st'>"wood"</span>)
)</div><div class='output co'>#&gt; [1] "c90963e4b507281024a89cbb54d8074f"</div><div class='input'>
<span class='co'># Extract the top BLAST hit for each fasta file.</span>
<span class='fu'>extract_blast_hits</span>(
  <span class='kw'>blast_results_dir</span> <span class='kw'>=</span> <span class='no'>temp_dir</span>,
  <span class='kw'>blast_results_pattern</span> <span class='kw'>=</span> <span class='st'>"\\.tsv$"</span>,
  <span class='kw'>database_path</span> <span class='kw'>=</span> <span class='kw pkg'>fs</span><span class='kw ns'>::</span><span class='fu'><a href='http://fs.r-lib.org/reference/path.html'>path</a></span>(<span class='no'>temp_dir</span>, <span class='st'>"wood"</span>),
  <span class='kw'>out_dir</span> <span class='kw'>=</span> <span class='no'>temp_dir</span>
)</div><div class='output co'>#&gt; <span class='message'>Parsed with column specification:</span>
#&gt; <span class='message'>cols(</span>
#&gt; <span class='message'>  qseqid = <span style='color: #BB0000;'>col_character()</span><span>,</span>
#&gt; <span class='message'>  sseqid = </span><span style='color: #BB0000;'>col_character()</span><span>,</span>
#&gt; <span class='message'>  pident = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  length = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  mismatch = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  gapopen = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  qstart = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  qend = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  sstart = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  send = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  evalue = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  bitscore = </span><span style='color: #00BB00;'>col_double()</span><span></span>
#&gt; <span class='message'>)</span></div><div class='output co'>#&gt; <span class='message'>Parsed with column specification:</span>
#&gt; <span class='message'>cols(</span>
#&gt; <span class='message'>  qseqid = </span><span style='color: #BB0000;'>col_character()</span><span>,</span>
#&gt; <span class='message'>  sseqid = </span><span style='color: #BB0000;'>col_character()</span><span>,</span>
#&gt; <span class='message'>  pident = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  length = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  mismatch = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  gapopen = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  qstart = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  qend = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  sstart = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  send = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  evalue = </span><span style='color: #00BB00;'>col_double()</span><span>,</span>
#&gt; <span class='message'>  bitscore = </span><span style='color: #00BB00;'>col_double()</span><span></span>
#&gt; <span class='message'>)</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list.files'>list.files</a></span>(<span class='no'>temp_dir</span>)</div><div class='output co'>#&gt;  [1] "wood.nhr"                       "wood.nin"                      
#&gt;  [3] "wood.nog"                       "wood.nsd"                      
#&gt;  [5] "wood.nsi"                       "wood.nsq"                      
#&gt;  [7] "woodmouse.fasta"                "woodmouse.tsv"                 
#&gt;  [9] "woodmouse.tsv.bestmatch.fasta"  "woodmouse2.fasta"              
#&gt; [11] "woodmouse2.tsv"                 "woodmouse2.tsv.bestmatch.fasta"</div><div class='input'><span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/ape/topics/read.dna'>read.FASTA</a></span>(<span class='kw pkg'>fs</span><span class='kw ns'>::</span><span class='fu'><a href='http://fs.r-lib.org/reference/path.html'>path</a></span>(<span class='no'>temp_dir</span>, <span class='st'>"woodmouse.tsv.bestmatch.fasta"</span>))</div><div class='output co'>#&gt; 1 DNA sequence in binary format stored in a list.
#&gt; 
#&gt; Sequence length: 965 
#&gt; 
#&gt; Label:
#&gt; No306 
#&gt; 
#&gt; Base composition:
#&gt;     a     c     g     t 
#&gt; 0.309 0.258 0.125 0.308 
#&gt; (Total: 965 bases)</div><div class='input'>
<span class='co'># Cleanup.</span>
<span class='kw pkg'>fs</span><span class='kw ns'>::</span><span class='fu'><a href='http://fs.r-lib.org/reference/delete.html'>file_delete</a></span>(<span class='no'>temp_dir</span>)</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Joel H. Nitta.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

